!function(factory){"use strict";"function"==typeof define&&define.amd?define(factory):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=factory():window.Sortable=factory()}(function(){"use strict";function Sortable(el,options){this.el=el,this.options=options=options||{},options.group=options.group||Math.random(),options.handle=options.handle||null,options.draggable=options.draggable||el.children[0]&&el.children[0].nodeName||(/[uo]l/i.test(el.nodeName)?"li":"*"),options.ghostClass=options.ghostClass||"sortable-ghost",options.ignore=options.ignore||"a, img",options.onAdd=_bind(this,options.onAdd||noop),options.onUpdate=_bind(this,options.onUpdate||noop),options.onRemove=_bind(this,options.onRemove||noop),el[expando]=options.group;for(var fn in this)"_"===fn.charAt(0)&&(this[fn]=_bind(this,this[fn]));void 0!==window.onpointerdown?(pointerdown="pointerdown",pointerup="pointerup",pointermove="pointermove",pointercancel="pointercancel"):(pointerdown="MSPointerDown",pointerup="MSPointerUp",pointermove="MSPointerMove",pointercancel="MSPointerCancel"),_on(el,"add",options.onAdd),_on(el,"update",options.onUpdate),_on(el,"remove",options.onRemove),_on(el,"mousedown",this._onTapStart),_on(el,"touchstart",this._onTapStart),supportIEdnd&&_on(el,"selectstart",this._onTapStart),_on(el,"dragover",this._onDragOver),_on(el,"dragenter",this._onDragOver),_on(el,pointerdown,this._onTapStart),_css(el,"touch-action","none"),_css(el,"-ms-touch-action","none"),touchDragOverListeners.push(this._onDragOver)}function _bind(ctx,fn){var args=slice.call(arguments,2);return fn.bind?fn.bind.apply(fn,[ctx].concat(args)):function(){return fn.apply(ctx,args.concat(slice.call(arguments)))}}function _closest(el,selector,ctx){if("*"===selector)return el;if(el){ctx=ctx||document,selector=selector.split(".");var tag=selector.shift().toUpperCase(),re=new RegExp("\\s("+selector.join("|")+")\\s","g");do if(!(""!==tag&&el.nodeName!=tag||selector.length&&((" "+el.className+" ").match(re)||[]).length!=selector.length))return el;while(el!==ctx&&(el=el.parentNode))}return null}function _globalDragOver(evt){evt.dataTransfer.dropEffect="move",evt.preventDefault()}function _on(el,event,fn){el.addEventListener(event,fn,!1)}function _off(el,event,fn){el.removeEventListener(event,fn,!1)}function _toggleClass(el,name,state){if(el)if(el.classList)el.classList[state?"add":"remove"](name);else{var className=(" "+el.className+" ").replace(/\s+/g," ").replace(" "+name+" ","");el.className=className+(state?" "+name:"")}}function _css(el,prop,val){if(el&&el.style){if(void 0===val)return document.defaultView&&document.defaultView.getComputedStyle?val=document.defaultView.getComputedStyle(el,""):el.currentStyle&&(val=el.currentStyle),void 0===prop?val:val[prop];el.style[prop]=val+("string"==typeof val?"":"px")}}function _find(ctx,tagName,iterator){if(ctx){var list=ctx.getElementsByTagName(tagName),i=0,n=list.length;if(iterator)for(;n>i;i++)iterator(list[i],i);return list}return[]}function _disableDraggable(el){return el.draggable=!1}function _unsilent(){_silent=!1}function _ghostInBottom(el,evt){var last=el.lastElementChild.getBoundingClientRect();return evt.clientY-(last.top+last.height)>5}var dragEl,ghostEl,rootEl,nextEl,lastEl,lastCSS,lastRect,activeGroup,tapEvt,touchEvt,pointerdown,pointerup,pointermove,pointercancel,expando="Sortable"+(new Date).getTime(),win=window,document=win.document,parseInt=win.parseInt,supportIEdnd=!!document.createElement("div").dragDrop,_silent=!1,_createEvent=function(event,item){var evt=document.createEvent("Event");return evt.initEvent(event,!0,!0),evt.item=item,evt},noop=function(){},slice=[].slice,touchDragOverListeners=[];return Sortable.prototype={constructor:Sortable,_applyEffects:function(){_toggleClass(dragEl,this.options.ghostClass,!0)},_onTapStart:function(evt){var touch=evt.touches&&evt.touches[0],target=(touch||evt).target,options=this.options,el=this.el;if(options.handle&&(target=_closest(target,options.handle,el)),target=_closest(target,options.draggable,el),target&&"selectstart"==evt.type&&"A"!=target.tagName&&"IMG"!=target.tagName&&target.dragDrop(),target&&!dragEl&&target.parentNode===el){tapEvt=evt,target.draggable=!0,Array.prototype.forEach.call(options.ignore.split(","),function(criteria){_find(target,criteria.trim(),_disableDraggable)}),touch&&(tapEvt={target:target,clientX:touch.clientX,clientY:touch.clientY},this._onDragStart(tapEvt,!0),evt.preventDefault()),("pointerdown"==evt.type||"MSPointerDown"==evt.type)&&(this._onDragStart(tapEvt,!0),evt.preventDefault()),_on(this.el,"dragstart",this._onDragStart),_on(this.el,"dragend",this._onDrop),_on(document,"dragover",_globalDragOver);try{document.selection?document.selection.empty():window.getSelection().removeAllRanges()}catch(err){}}},_emulateDragOver:function(){if(touchEvt){_css(ghostEl,"display","none");var target=document.elementFromPoint(touchEvt.clientX,touchEvt.clientY),parent=target,group=this.options.group,i=touchDragOverListeners.length;if(parent)do{if(parent[expando]===group){for(;i--;)touchDragOverListeners[i]({clientX:touchEvt.clientX,clientY:touchEvt.clientY,target:target,rootEl:parent});break}target=parent}while(parent=parent.parentNode);_css(ghostEl,"display","")}},_onTouchMove:function(evt){if(tapEvt){var touch="pointermove"==evt.type||"MSPointerMove"==evt.type?evt:evt.touches[0],dx=touch.clientX-tapEvt.clientX,dy=touch.clientY-tapEvt.clientY;touchEvt=touch,_css(ghostEl,"webkitTransform","translate3d("+dx+"px,"+dy+"px,0)"),_css(ghostEl,"mozTransform","translate3d("+dx+"px,"+dy+"px,0)"),_css(ghostEl,"msTransform","translate3d("+dx+"px,"+dy+"px,0)"),_css(ghostEl,"transform","translate3d("+dx+"px,"+dy+"px,0)"),evt.preventDefault()}},_onDragStart:function(evt,isTouch){var target=evt.target,dataTransfer=evt.dataTransfer;if(rootEl=this.el,dragEl=target,nextEl=target.nextSibling,activeGroup=this.options.group,isTouch){var ghostRect,rect=target.getBoundingClientRect(),css=_css(target);ghostEl=target.cloneNode(!0),_css(ghostEl,"top",rect.top-parseInt(css.marginTop,10)),_css(ghostEl,"left",rect.left-parseInt(css.marginLeft,10)),_css(ghostEl,"width",rect.width),_css(ghostEl,"height",rect.height),_css(ghostEl,"opacity","0.8"),_css(ghostEl,"position","fixed"),_css(ghostEl,"zIndex","100000"),rootEl.appendChild(ghostEl),ghostRect=ghostEl.getBoundingClientRect(),_css(ghostEl,"width",2*rect.width-ghostRect.width),_css(ghostEl,"height",2*rect.height-ghostRect.height),_on(document,"touchmove",this._onTouchMove),_on(document,"touchend",this._onDrop),_on(document,"touchcancel",this._onDrop),_on(document,pointermove,this._onTouchMove),_on(document,pointerup,this._onDrop),_on(document,pointercancel,this._onDrop),this._loopId=setInterval(this._emulateDragOver,150)}else dataTransfer.effectAllowed="move",dataTransfer.setData("Text",target.textContent),_on(document,"drop",this._onDrop);setTimeout(this._applyEffects)},_onDragOver:function(evt){if(!_silent&&activeGroup===this.options.group&&(void 0===evt.rootEl||evt.rootEl===this.el)){var el=this.el,target=_closest(evt.target,this.options.draggable,el);if(0===el.children.length||el.children[0]===ghostEl||el===evt.target&&_ghostInBottom(el,evt))el.appendChild(dragEl);else if(target&&target!==dragEl&&void 0!==target.parentNode[expando]){lastEl!==target&&(lastEl=target,lastCSS=_css(target),lastRect=target.getBoundingClientRect());var after,rect=lastRect,width=rect.right-rect.left,height=rect.bottom-rect.top,floating=/left|right|inline/.test(lastCSS.cssFloat+lastCSS.display),skew=(floating?(evt.clientX-rect.left)/width:(evt.clientY-rect.top)/height)>.5,isWide=target.offsetWidth>dragEl.offsetWidth,isLong=target.offsetHeight>dragEl.offsetHeight,nextSibling=target.nextSibling;_silent=!0,setTimeout(_unsilent,30),after=floating?target.previousElementSibling===dragEl&&!isWide||skew>.5&&isWide:target.nextElementSibling!==dragEl&&!isLong||skew>.5&&isLong,after&&!nextSibling?el.appendChild(dragEl):target.parentNode.insertBefore(dragEl,after?nextSibling:target)}}},_onDrop:function(evt){clearInterval(this._loopId),_off(document,"drop",this._onDrop),_off(document,"dragover",_globalDragOver),_off(this.el,"dragend",this._onDrop),_off(this.el,"dragstart",this._onDragStart),_off(this.el,"selectstart",this._onTapStart),_off(document,"touchmove",this._onTouchMove),_off(document,"touchend",this._onDrop),_off(document,"touchcancel",this._onDrop),_off(document,pointermove,this._onTouchMove),_off(document,pointerup,this._onDrop),_off(document,pointercancel,this._onDrop),evt&&(evt.preventDefault(),evt.stopPropagation(),ghostEl&&ghostEl.parentNode.removeChild(ghostEl),dragEl&&(_disableDraggable(dragEl),_toggleClass(dragEl,this.options.ghostClass,!1),rootEl.contains(dragEl)?dragEl.nextSibling!==nextEl&&dragEl.dispatchEvent(_createEvent("update",dragEl)):(rootEl.dispatchEvent(_createEvent("remove",dragEl)),dragEl.dispatchEvent(_createEvent("add",dragEl)))),rootEl=dragEl=ghostEl=nextEl=tapEvt=touchEvt=lastEl=lastCSS=activeGroup=null)},destroy:function(){var el=this.el,options=this.options;_off(el,"add",options.onAdd),_off(el,"update",options.onUpdate),_off(el,"remove",options.onRemove),_off(el,"mousedown",this._onTapStart),_off(el,"touchstart",this._onTapStart),_off(el,"selectstart",this._onTapStart),_off(el,pointerdown,this._onTapStart),_off(el,"dragover",this._onDragOver),_off(el,"dragenter",this._onDragOver),Array.prototype.forEach.call(el.querySelectorAll("[draggable]"),function(el){el.removeAttribute("draggable")}),touchDragOverListeners.splice(touchDragOverListeners.indexOf(this._onDragOver),1),this._onDrop(),this.el=null}},Sortable.utils={on:_on,off:_off,css:_css,find:_find,bind:_bind,closest:_closest,toggleClass:_toggleClass},Sortable.version="0.1.9",Sortable});